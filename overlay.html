<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; script-src 'self' 'unsafe-inline'">
  <title>Timer Overlay</title>
  <style>
    body { 
      margin: 0; 
      padding: 0;
      background: transparent; 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow: hidden;
    }
    .overlay-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 8px;
      background: rgba(0, 0, 0, 0.1);
      z-index: 9999;
      cursor: move;
      -webkit-app-region: drag;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #67d7fd, #67d7fd);
      width: 0%;
      transition: width 0.3s ease;
      position: relative;
    }
    .progress-bar.work {
      background: linear-gradient(90deg, #67d7fd, #67d7fd);
    }
    .progress-bar.break {
      background: linear-gradient(90deg, #7bed9f, #7bed9f);
    }
    .progress-bar.long-break {
      background: linear-gradient(90deg, #ffa502, #ffa502);
    }
    .timer-info {
      position: fixed;
      top: 12px;
      left: 20px;
      color: white;
      font-size: 12px;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
      z-index: 10000;
      pointer-events: none;
    }
    .no-drag {
      -webkit-app-region: no-drag;
      pointer-events: auto;
    }
  </style>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const progressBar = document.getElementById('progressBar');
      const timeEl = document.getElementById('overlayTime');
      const modeEl = document.getElementById('overlayMode');
      
      if (window.electronAPI && window.electronAPI.onTimerUpdate) {
        window.electronAPI.onTimerUpdate((state) => {
          if (progressBar && state.totalTime > 0) {
            const progress = ((state.totalTime - state.currentTime) / state.totalTime) * 100;
            progressBar.style.width = progress + '%';
            
            // Update color based on mode
            progressBar.className = 'progress-bar ' + state.currentMode;
          }
          
          if (timeEl) timeEl.textContent = formatTime(state.currentTime);
          if (modeEl) modeEl.textContent = modeLabel(state.currentMode);
        });
      }
      
      function formatTime(sec) {
        const m = Math.floor(sec / 60).toString().padStart(2, '0');
        const s = (sec % 60).toString().padStart(2, '0');
        return `${m}:${s}`;
      }
      
      function modeLabel(m) {
        return m === 'work' ? 'Work' : (m === 'break' ? 'Break' : 'Long Break');
      }
    });
  </script>
</head>
<body>
  <div class="overlay-container">
    <div id="progressBar" class="progress-bar work"></div>
  </div>
  <div class="timer-info">
    <div id="overlayTime">25:00</div>
    <div id="overlayMode">Work</div>
  </div>
</body>
</html>


